// prisma/schema.prisma
// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  password  String
  name      String?
  role      String   @default("STAFF") // SQLite does not support enums, using String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("User")
}

model Shipment {
  id             String           @id @default(uuid())
  waybillNumber  String           @unique // e.g., KPL-8829
  
  // Sender Details
  senderName     String
  senderPhone    String
  senderAddress  String?
  
  // Receiver Details
  receiverName   String
  receiverPhone  String
  receiverAddress String?
  
  // Shipment Details
  origin         String
  destination    String
  weight         Float?
  price          Float?
  
  currentStatus  String   @default("PENDING")
  receiverSignature String? // Base64 signature
  
  events         TrackingEvent[]
  
  createdAt      DateTime         @default(now())
  updatedAt      DateTime         @updatedAt

  @@map("Shipment")
}

model TrackingEvent {
  id          String         @id @default(uuid())
  shipmentId  String
  shipment    Shipment       @relation(fields: [shipmentId], references: [id])
  
  status      String
  location    String         // e.g., "Dar es Salaam Hub"
  remarks     String?        // e.g., "Dispatched to Mwanza Branch"
  
  timestamp   DateTime       @default(now())

  @@map("TrackingEvent")
}
